<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Robot Controller</title>
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#ffffff">
<link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIlJvYm90IENvbnRyb2xsZXIiLAogICJzaG9ydF9uYW1lIjogIlJvYm90IiwKICAiZGlzcGxheSI6ICJzdGFuZGFsb25lIiwKICAic3RhcnRfdXJsIjogIi4iLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiNmZmZmZmYiLAogICJ0aGVtZV9jb2xvciI6ICIjZmZmZmZmIgp9">
<style>
/* ----------  RESET  ---------- */
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{height:100vh;display:flex;flex-direction:column;font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial;font-size:2.8vh;background:#fff;color:#000;touch-action:none;overflow:hidden}
button{border:none;background:none;font:inherit;color:inherit}
/* ----------  LAYOUT  ---------- */
.top-bar{height:10vh;display:flex;align-items:center;justify-content:space-between;padding:0 4vw;border-bottom:2px solid #000}
.status-dot{width:3vh;height:3vh;border-radius:50%;background:#40a351;animation:pulse 2s infinite}
.portrait-warning{position:fixed;inset:0;background:#fff;color:#000;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:999;text-align:center}
@media (orientation:landscape){.portrait-warning{display:none}}
/* ----------  CONTROLS  ---------- */
.control-area{flex:1;display:flex;align-items:center;justify-content:space-between;padding:0 6vw}
.btn-group{display:flex;flex-direction:column;gap:3vh}
.btn-group.horizontal{flex-direction:row}
.control-btn{width:22vh;height:22vh;border:3px solid #000;border-radius:50%;background:#fff;font-size:10vh;display:flex;align-items:center;justify-content:center;transition:transform .1s}
.control-btn:active{background:#000;color:#fff;transform:scale(.95)}
.bottom-bar{height:14vh;border-top:2px solid #000;display:flex;align-items:center;justify-content:space-around;padding:0 4vw}
.power-slider{-webkit-appearance:none;appearance:none;width:40vw;height:6px;background:#ccc;border-radius:3px}
.power-slider::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:24px;height:24px;background:#000;border-radius:50%}
.cutter-btn{padding:2vh 4vh;border:2px solid #000;border-radius:1.5vh;font-weight:700;background:#fff}
.cutter-btn.on{background:#000;color:#fff}
/* ----------  UTILS  ---------- */
.hidden{display:none}@keyframes pulse{50%{opacity:.5}}
</style>
<base target="_blank">
</head>
<body>

<!-- 1. portrait lock -->
<div class="portrait-warning">
  <span style="font-size:10vh">üì±</span>
  <h2>Please rotate your device</h2>
  <p>This app works in landscape mode.</p>
</div>

<!-- 2. main screen -->
<div class="top-bar">
  <div style="display:flex;align-items:center;gap:1vw">
    <span class="status-dot"></span>
    <span>Ready</span>
  </div>
  <button onclick="location.reload()">Restart</button>
</div>

<div class="control-area">
  <div class="btn-group horizontal">
    <button class="control-btn" data-dir="left">‚Üê</button>
    <button class="control-btn" data-dir="right">‚Üí</button>
  </div>
  <div class="btn-group">
    <button class="control-btn" data-dir="fwd">‚Üë</button>
    <button class="control-btn" data-dir="back">‚Üì</button>
  </div>
</div>

<div class="bottom-bar">
  <div style="display:flex;align-items:center;gap:2vw">
    <span>Power</span>
    <input type="range" class="power-slider" id="pwr" min="0" max="100" value="70">
    <span id="pwrVal">70%</span>
  </div>
  <button class="cutter-btn" id="cut">Cutter OFF</button>
</div>

<script>
/* ----------  STATE  ---------- */
let power=70, cutter=false, dir={fwd:0,back:0,left:0,right:0}, interval;

/* ----------  HELPERS  ---------- */
const $=q=>document.querySelector(q);
const updatePwr=e=>{power=e.target.value;$('#pwrVal').textContent=power+'%'};
const toggleCut=()=>{
  cutter=!cutter;
  $('#cut').classList.toggle('on');
  $('#cut').textContent='Cutter '+(cutter?'ON':'OFF');
};

/* ----------  MOVEMENT  ---------- */
function drive(){
  let L=0,R=0;
  if(dir.fwd){ L=power; R=power; }
  if(dir.back){ L=-power; R=-power; }
  if(dir.right){ R*=0.3; }
  if(dir.left){ L*=0.3; }
  console.log('Motors ‚Üí Left:',L,'Right:',R,'Cutter:',cutter);
}
function start(){ if(!interval) interval=setInterval(drive,50) }
function stop(){ clearInterval(interval); interval=null; drive(); }

/* ----------  BUTTONS  ---------- */
document.querySelectorAll('.control-btn').forEach(b=>{
  const k=b.dataset.dir;
  const press=()=>{dir[k]=1;start()};
  const release=()=>{dir[k]=0;if(!Object.values(dir).some(v=>v))stop()};
  b.addEventListener('touchstart',press,{passive:false});
  b.addEventListener('touchend',release);
  b.addEventListener('mousedown',press);
  b.addEventListener('mouseup',release);
});
$('#pwr').addEventListener('input',updatePwr);
$('#cut').addEventListener('click',toggleCut);

/* ----------  PWA SERVICE-WORKER (cache-only) ---------- */
if('serviceWorker' in navigator){
  const blob=new Blob([`
self.addEventListener('install',e=>{
  e.waitUntil(caches.open('v1').then(c=>c.addAll(['./'])));
  self.skipWaiting();
});
self.addEventListener('fetch',e=>{
  e.respondWith(caches.match(e.request).then(r=>r||fetch(e.request)));
});`],{type:'application/javascript'});
  const url=URL.createObjectURL(blob);
  navigator.serviceWorker.register(url);
}
</script>
</body>
</html>